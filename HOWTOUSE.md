# 如何使用 InfoCollection Skill 和 Agent 包

本文档详细说明如何在你的 Claude Code 项目中安装、配置并使用智能信息收集系统（InfoCollection）提供的 Skill 和 Agent 包。

**目录**
- [通过市场安装](#通过市场安装)
- [本地安装](#本地安装)
- [配置说明](#配置说明)
- [第一次使用](#第一次使用)
- [常见问题](#常见问题)

---

## 通过市场安装

先通过下面的命令添加我们的 Marketplace:

```
/plugin marketplace add lostabaddon/CCMarketplace
```

/然后在 "Browse and install plugins" 中找到本市场中的 InfoCollector 插件进行安装。

此后可以在 "Manage and uninstall plugins" 中进行更新。

---

## 本地安装

如果你是有经验的 Claude Code 用户，可以按照以下步骤快速上手：

### 1. 准备相关文件夹

确保您的工作目录下有 `.claude` 文件夹，以及其中有 `skills` 和 `agents` 这两个文件夹

### 2. 复制 Skill 和 Agent 文件

将本项目的 `skills` 和 `agents` 目录复制到您工作目录 `claude` 目录下。

### 3. 复制 SITE.md 配置文件

将本项目的 `SITE.md` 复制到您的工作目录下。

**注意**：不需要复制 `PERSONEL.md`，系统会在首次启动时自动创建！

### 4. 在 Claude Code 中使用

在你的项目中，告诉 Claude：

```
帮我收集今天关于人工智能的最新信息
```

**首次启动时**，系统会：
1. 检测 `PERSONEL.md` 不存在
2. 自动启动交互式初始化流程
3. 询问你的语言偏好和默认关注领域
4. 自动生成个人配置文件

---

## 配置说明

### 理解配置文件

系统使用两个主要配置文件：

#### 1. PERSONEL.md - 个人偏好配置

此文件定义了你的个人信息收集偏好。

**主要配置项：**

| 配置项 | 说明 | 默认值 | 修改方法 |
|--------|------|--------|---------|
| **主要语言** | 报告生成的主要语言 | 中文 | 编辑 `## 语言偏好` 部分 |
| **次要语言** | 允许的其他语言 | 英文 | 编辑 `## 语言偏好` 部分 |
| **默认关注领域** | 不指定时的默认收集领域 | 科技、国际要闻 | 编辑 `### 默认关注领域` 部分 |
| **信息类型偏好** | 偏好的信息形式 | 新闻、博客、学术 | 编辑 `## 信息类型偏好` 部分 |
| **时间范围** | 默认收集时间窗口 | 过去 24 小时 | 编辑 `## 时间范围` 部分 |
| **启用 WebSearch** | 是否启用全网搜索 | 是 | 编辑 `### 双通道搜索配置` 部分 |
| **WebSearch 权重** | 相对于 SITE.md 的权重 | 30% | 编辑 `### 双通道搜索配置` 部分 |

**示例配置修改：**

```markdown
# 原始配置
## 语言偏好
- 主要语言：中文
- 次要语言：英文

# 修改为只使用英文
## 语言偏好
- 主要语言：英文
- 次要语言：无
```

#### 2. SITE.md - 可靠信息源配置

此文件定义了系统可以访问的可靠信息源。

**结构说明：**

```markdown
## 大类别（二级标题）
### 子类别（三级标题）
- **信息源名称（粗体）**
  - URL: {网址}
  - 类型: {标签}
  - 语言: {语言}
```

**示例：**

```markdown
## 科技与技术

### 人工智能
- **OpenAI Blog**
  - URL: https://openai.com/blog
  - 类型: AI、GPT、研究
  - 语言: 英文

- **机器之心**
  - URL: https://www.jiqizhixin.com/
  - 类型: AI、机器学习、深度学习
  - 语言: 中文
```

### 修改配置

#### 修改 PERSONEL.md

用你喜欢的文本编辑器打开 PERSONEL.md：

```bash
# 使用 VS Code
code ~/my-project/PERSONEL.md

# 或使用 nano（命令行编辑器）
nano ~/my-project/PERSONEL.md

# 或使用 vim
vim ~/my-project/PERSONEL.md
```

**常见修改示例：**

1. 修改默认关注领域：
   ```markdown
   # 如果你主要关注金融新闻和经济信息
   ### 默认关注领域
   1. **金融与经济**
      - 股市行情
      - 加密货币
      - 商业分析
   ```

2. 调整 WebSearch 权重：
   ```markdown
   # 如果你想加大对网络搜索的依赖
   ### 双通道搜索配置
   - **启用广泛网络搜索（WebSearch）**：是
   - **WebSearch 相对权重**：50%（相对于 SITE.md 的 50%）
   ```

#### 添加新的信息源到 SITE.md

假设你想添加一个新的信息源：

1. 打开 SITE.md：
   ```bash
   code ~/my-project/SITE.md
   ```

2. 找到合适的类别（或创建新类别）

3. 添加新信息源，格式如下：
   ```markdown
   - **Medium**
     - URL: https://medium.com/
     - 类型: 技术文章、博客
     - 语言: 英文
   ```

4. 保存文件

**添加信息源的最佳实践：**

- 使用可靠、常更新的信息源
- 为 URL 字段使用信息源的主页（如 `https://example.com/`）
- 在"类型"字段中使用逗号分隔的标签
- 保持信息源在合适的类别下

### 完成配置检查

确保所有必需的配置都正确设置：

```bash
# 检查 SITE.md 是否存在且非空
[ -s ~/my-project/SITE.md ] && echo "✓ SITE.md 已安装" || echo "✗ SITE.md 缺失"

# 检查是否包含至少一个信息源
grep -q "^- \*\*" ~/my-project/SITE.md && echo "✓ SITE.md 包含信息源" || echo "✗ SITE.md 可能为空"
```

**说明**：不需要提前准备 `PERSONEL.md`，系统会在首次启动时自动创建

---

## 第一次使用

现在你已经完成了安装和配置，可以进行第一次使用了。

### 启动 Skill

在 Claude Code 中，有两种方式启动信息收集系统：

#### 方式 1：使用 Skill 命令（推荐）

```
/info-collector
```

输入此命令后，系统会提示你输入需求。

#### 方式 2：直接告诉 Claude

```
帮我收集今天关于人工智能的最新信息
```

Claude 会自动识别并启动 `/info-collector` Skill。

### 第一次使用示例

#### 场景 1：简单的每日新闻收集

**你的输入：**
```
收集今天的科技新闻
```

**系统会：**
1. 分析你的需求：收集科技领域的新闻，时间范围为过去 24 小时
2. 从 SITE.md 选择科技相关信息源
3. 执行 WebSearch 全网搜索
4. 并行启动 source-processor Agent 处理各信息源
5. 为每个网页启动 webpage-analyzer Agent 进行深度分析
6. 生成最终报告

**预期输出：**
- 一份组织清晰的信息收集报告
- 报告保存在当天的目录下（如 `2025-10-27/最终报告.md`）
- 可能发现并添加新的信息源到 SITE.md

#### 场景 2：特定领域的深度研究

**你的输入：**
```
帮我收集过去一周关于大语言模型的最新研究和应用进展
```

**系统会：**
1. 分析需求：大语言模型、过去 7 天、包括学术论文
2. 从 SITE.md 选择 AI 相关信息源
3. 进行多个 WebSearch 查询以覆盖不同角度
4. 生成包含学术论文、技术博客和新闻的综合报告

#### 场景 3：多领域信息追踪

**你的输入：**
```
收集今天的 AI 新闻、网络安全事件和国际要闻
```

**系统会：**
1. 识别三个关注领域
2. 选择多个相关信息源
3. 同时处理这些信息源
4. 按领域分类组织最终报告

### 查看收集结果

收集完成后，检查生成的文件：

```bash
# 查看今天生成的文件
ls -la ~/my-project/2025-10-27/

# 查看最终报告
cat ~/my-project/2025-10-27/最终报告.md

# 查看单个信息源的总结
cat ~/my-project/2025-10-27/TechCrunch-总结.md

# 查看新发现的信息源评估
cat ~/my-project/2025-10-27/新增信息源评估.md
```

### 理解输出格式

系统生成的报告包含以下部分：

#### 1. 最终报告（最终报告.md）

**包含内容：**
- 收集摘要：主要发现和趋势
- 按领域分类的详细内容
- 所有信息源的引用列表
- 新增信息源统计

**示例结构：**
```
# 信息收集报告

**收集时间范围**: 过去 24 小时
**收集领域**: 人工智能、科技
**报告生成时间**: 2025-10-27 14:30
...

## 一、科技与技术

### 人工智能

根据多个来源的最新报道[1][2][5]，...

### 网络安全

...

## 信息源列表

1. [标题1](URL1) - 来源: TechCrunch
2. [标题2](URL2) - 来源: 机器之心
...
```

#### 2. 信息源总结文件（{信息源名称}-总结.md）

为每个处理过的信息源生成一个总结文件。

**示例：TechCrunch-总结.md**
```
# TechCrunch - 信息汇总

**信息源**: TechCrunch
**信息源 URL**: https://techcrunch.com/
**收集时间范围**: 过去 24 小时
**收集数量**: 5 条

---

## 综合分析

本次从 TechCrunch 收集到的信息主要集中在...

---

## 信息来源

1. [标题1](URL1)
2. [标题2](URL2)
...
```

#### 3. 新增信息源评估（新增信息源评估.md）

如果系统发现了新的有价值的信息源，会在此文件中记录评估结果。

### 持续改进

在使用过程中，系统会不断改进：

1. **自动添加新信息源**
   - 当发现高分（≥7.5分）的新信息源时，自动添加到 SITE.md
   - 中等分（6.0-7.4分）的网站会添加但标注"待审核"

2. **定期审核信息源**
   - 定期检查 SITE.md 中的信息源是否仍然活跃
   - 移除失效或低质量的信息源

3. **优化搜索策略**
   - 根据用户需求自动调整 WebSearch 查询
   - 改进信息筛选和去重

---

## 常见问题

### Q0: 首次启动时系统是否会提示我创建 PERSONEL.md？

**答案**：是的！系统会自动检测并创建。

**流程说明**：
1. 首次启动 Skill 时，系统会检查 `PERSONEL.md` 是否存在
2. 如果不存在，会自动启动交互式初始化
3. 系统会询问你：
   - 主要语言选择
   - 默认关注领域
4. 根据你的回答自动生成 `PERSONEL.md`
5. 然后继续进行信息收集任务

**你不需要手动创建此文件！**

---

### Q1: 安装后 Skill 没有出现

**问题现象：**
- 在 Claude Code 中输入 `/info-collector` 后无反应
- 系统无法识别 Skill

**解决方案：**

1. 验证文件路径正确：
   ```bash
   # 检查 Skill 文件是否存在
   ls -la ~/.claude/skills/info-collector/skill.md

   # 或在项目中
   ls -la ~/my-project/.claude/skills/info-collector/skill.md
   ```

2. 检查 Skill 文件格式：
   ```bash
   # 查看前 5 行，应该包含 YAML frontmatter
   head -5 ~/.claude/skills/info-collector/skill.md
   ```

   应该看到：
   ```yaml
   ---
   name: info-collector
   description: "..."
   ---
   ```

3. 重启 Claude Code：
   ```bash
   # 退出并重新打开 Claude Code
   ```

4. 检查路径设置：
   - 确认 Skill 文件在 `~/.claude/skills/` 或项目的 `.claude/skills/` 下
   - Claude Code 可能需要显式配置 Skills 目录

### Q2: 无法找到 Agent

**问题现象：**
- 运行 Skill 后报错"找不到 source-processor Agent"
- 其他 Agent 也无法被调用

**解决方案：**

1. 检查所有三个 Agent 文件都已复制：
   ```bash
   # 检查是否存在
   ls -la ~/.claude/agents/
   ```

   应该看到：
   ```
   -rw-r--r--  source-processor.md
   -rw-r--r--  webpage-analyzer.md
   -rw-r--r--  site-evaluator.md
   ```

2. 检查 Agent 文件格式：
   ```bash
   # 检查每个 Agent 的 frontmatter
   head -5 ~/.claude/agents/source-processor.md
   ```

3. 检查文件名是否正确（区分大小写）：
   - Linux/macOS：文件名区分大小写
   - 确保文件名完全匹配

### Q3: 配置文件缺失或格式错误

**问题现象：**
- SITE.md 缺失
- 无法解析 SITE.md

**解决方案：**

**关于 PERSONEL.md**：
- 如果 PERSONEL.md 缺失或为空，系统会自动启动交互式初始化创建它
- 无需手动处理！

**关于 SITE.md**：

1. 验证文件存在：
   ```bash
   # 检查 SITE.md
   ls -la ~/my-project/SITE.md
   ```

2. 检查文件不为空：
   ```bash
   # 检查文件大小（应该 > 100 字节）
   wc -c ~/my-project/SITE.md
   ```

3. 检查 Markdown 格式：
   ```bash
   # 查看前 20 行
   head -20 ~/my-project/SITE.md
   ```

   应该看到标准的 Markdown 结构。

4. 如果文件损坏，重新复制：
   ```bash
   # 从源代码重新复制
   cp /tmp/infocol-source/SITE.md ~/my-project/SITE.md
   ```

### Q4: 网页无法访问或分析失败

**问题现象：**
- 某些信息源返回访问失败
- 信息收集报告中有"处理失败"的消息

**解决方案：**

1. **网络连接问题**
   ```bash
   # 测试网络连接
   ping -c 2 techcrunch.com
   ```

2. **信息源 URL 失效**
   - 验证 SITE.md 中的 URL 是否正确
   - 在浏览器中测试 URL 是否可访问
   - 如果失效，更新或移除该信息源

3. **API 限制**
   - WebFetch 和 WebSearch 可能有调用频率限制
   - 系统会自动处理这些限制
   - 如果频繁发生，减少同时处理的信息源数量

4. **反爬虫机制**
   - 某些网站可能阻止自动访问
   - 这是正常的，系统会跳过这些网站
   - 在 SITE.md 中移除问题网站

### Q5: 生成的报告为空

**问题现象：**
- 收集完成但报告中没有内容
- 无法找到符合条件的信息

**解决方案：**

1. 检查关注领域是否匹配：
   ```bash
   # 查看 SITE.md 中是否有相关信息源
   grep -i "ai\|人工智能" ~/my-project/SITE.md
   ```

2. 扩大时间范围：
   - 默认是过去 24 小时
   - 尝试扩大到过去 7 天或更长

3. 检查信息源是否活跃：
   - 在浏览器中手动测试一些 SITE.md 中的 URL
   - 确保至少有一些信息源有新内容

4. 添加更多信息源：
   - 编辑 SITE.md，添加你感兴趣的信息源
   - 重新运行信息收集

### Q6: 如何自定义信息收集频率

**使用场景：**
- 你想每天自动收集一次信息
- 或想在特定时间运行收集任务

**方案：**

由于这是基于 Claude Code 的系统，自动化频率取决于 Claude Code 的运行方式。以下是几个选项：

1. **手动运行**：每次需要信息时手动输入 `/info-collector`

2. **使用系统调度**：
   ```bash
   # macOS/Linux: 使用 cron（每天早上 9 点运行）
   # 编辑 crontab
   crontab -e

   # 添加以下行（需要配置 Claude Code 支持 CLI 调用）
   0 9 * * * /path/to/claude-code run-skill info-collector
   ```

3. **其他方案**：
   - 使用外部工作流工具（如 GitHub Actions）定期触发
   - 与其他任务管理系统集成

### Q7: 需要帮助或报告问题

**获取技术支持：**

1. 查看项目的 README.md 了解架构细节
2. 查看各 Agent 定义文件（`.claude/agents/`）了解具体实现
3. 检查生成的日志文件（通常在工作目录下）
4. 在项目的 Issue tracker 上报告问题

**提供反馈时包括：**
- Claude Code 版本
- 完整的错误消息
- 相关的配置设置
- 尝试过的解决方案

---

## 进阶配置

### 自定义 WebSearch 权重

如果你想调整 WebSearch 与 SITE.md 信息源的相对权重，编辑 PERSONEL.md：

```markdown
### 双通道搜索配置
- **优先使用可靠源（SITE.md）**：是
- **启用广泛网络搜索（WebSearch）**：是
- **WebSearch 相对权重**：50%（修改此值，默认为 30%）
```

权重的含义：
- **30%**：偏好可靠源，WebSearch 为辅助
- **50%**：平衡使用两个通道
- **70%**：强调网络发现，可能找到更多新信息源

### 调整新信息源评分标准

在 PERSONEL.md 中：

```markdown
### 新信息源发现与管理
- **自动添加新信息源**：是
- **自动添加阈值**：7.5 分（降低此值使系统更容易添加新源）
- **人工审核阈值**：6.0-7.4 分
```

### 管理已收集的信息

所有收集的信息保存在日期目录下：

```bash
# 查看所有收集历史
ls -d ~/my-project/*/

# 删除旧的收集（小心操作！）
rm -rf ~/my-project/2025-10-20/

# 归档收集数据
tar -czf ~/my-project/archives/2025-10.tar.gz ~/my-project/2025-10-*/
```

---

## 总结

你现在已经完成了以下步骤：

✅ 安装了 Skill 和 Agent 包
✅ 配置了个人偏好和信息源
✅ 进行了第一次信息收集
✅ 了解了输出格式和常见问题
✅ 可以开始使用系统进行日常信息收集

## 后续步骤

1. **定期更新信息源**
   - 定期审查 SITE.md 中的信息源
   - 移除失效的网站
   - 添加新发现的有价值信息源

2. **个性化配置**
   - 根据自己的需求调整 PERSONEL.md
   - 创建多个配置文件以支持不同的收集任务

3. **深入使用**
   - 探索不同的收集场景
   - 学习 Agent 定义以理解系统工作原理
   - 考虑扩展系统功能

有问题或需要支持时，请参考 README.md 或项目文档。

祝你信息收集愉快！
